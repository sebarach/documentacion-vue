<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Negocio SQL | Documentacion General !💻💻💻</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="shortcut icon" type="image/x-icon" href="/documentacion-vue/favicon.ico">
    <script>
    (function(){

      var doc = document.documentElement;
      var w = window;
    
      var prevScroll = w.scrollY || doc.scrollTop;
      var curScroll;
      var direction = 0;
      var prevDirection = 0;
    
      var header = document.getElementById('site-header');
    
      var checkScroll = function() {
  
        curScroll = w.scrollY || doc.scrollTop;
        if (curScroll > prevScroll) { 
          //scrolled up
          direction = 2;
        }
        else if (curScroll < prevScroll) { 
          //scrolled down
          direction = 1;
        }
    
        if (direction !== prevDirection) {
          toggleHeader(direction, curScroll);
        }
        
        prevScroll = curScroll;
      };
    
      var toggleHeader = function(direction, curScroll) {
        if (direction === 2 && curScroll >= 100) { 
    
          //header.classList.add('hide');
          let element = document.getElementsByTagName('header')[0];
          element.setAttribute("hidden", "hidden");
          prevDirection = direction;
        }
        else if (direction === 1 && curScroll < 100) {
          let element = document.getElementsByTagName('header')[0];
          element.removeAttribute("hidden");
          prevDirection = direction;
        }
      };
      
      window.addEventListener('scroll', checkScroll);
      
    })();
    </script>
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/documentacion-vue/assets/css/0.styles.7d8547ba.css" as="style"><link rel="preload" href="/documentacion-vue/assets/js/app.840065b6.js" as="script"><link rel="preload" href="/documentacion-vue/assets/js/2.b8b9754a.js" as="script"><link rel="preload" href="/documentacion-vue/assets/js/41.3b383c52.js" as="script"><link rel="prefetch" href="/documentacion-vue/assets/js/10.65fac935.js"><link rel="prefetch" href="/documentacion-vue/assets/js/11.4640356c.js"><link rel="prefetch" href="/documentacion-vue/assets/js/12.96624e05.js"><link rel="prefetch" href="/documentacion-vue/assets/js/13.31ff7052.js"><link rel="prefetch" href="/documentacion-vue/assets/js/14.ad88d610.js"><link rel="prefetch" href="/documentacion-vue/assets/js/15.6712a1ce.js"><link rel="prefetch" href="/documentacion-vue/assets/js/16.7cc9a5d6.js"><link rel="prefetch" href="/documentacion-vue/assets/js/17.f037ad6b.js"><link rel="prefetch" href="/documentacion-vue/assets/js/18.e97b46aa.js"><link rel="prefetch" href="/documentacion-vue/assets/js/19.c0b356a4.js"><link rel="prefetch" href="/documentacion-vue/assets/js/20.ae7e05a0.js"><link rel="prefetch" href="/documentacion-vue/assets/js/21.aed94fe0.js"><link rel="prefetch" href="/documentacion-vue/assets/js/22.80b61cc0.js"><link rel="prefetch" href="/documentacion-vue/assets/js/23.aa643ef5.js"><link rel="prefetch" href="/documentacion-vue/assets/js/24.5f29c6cb.js"><link rel="prefetch" href="/documentacion-vue/assets/js/25.6d36ccf2.js"><link rel="prefetch" href="/documentacion-vue/assets/js/26.543c573c.js"><link rel="prefetch" href="/documentacion-vue/assets/js/27.66e82807.js"><link rel="prefetch" href="/documentacion-vue/assets/js/28.7a700bc2.js"><link rel="prefetch" href="/documentacion-vue/assets/js/29.3f0f3add.js"><link rel="prefetch" href="/documentacion-vue/assets/js/3.a149a098.js"><link rel="prefetch" href="/documentacion-vue/assets/js/30.698badd9.js"><link rel="prefetch" href="/documentacion-vue/assets/js/31.b3202d6d.js"><link rel="prefetch" href="/documentacion-vue/assets/js/32.5310f79e.js"><link rel="prefetch" href="/documentacion-vue/assets/js/33.9023fe1f.js"><link rel="prefetch" href="/documentacion-vue/assets/js/34.7bae907b.js"><link rel="prefetch" href="/documentacion-vue/assets/js/35.e5463af1.js"><link rel="prefetch" href="/documentacion-vue/assets/js/36.98a34771.js"><link rel="prefetch" href="/documentacion-vue/assets/js/37.195b32b4.js"><link rel="prefetch" href="/documentacion-vue/assets/js/38.56709a27.js"><link rel="prefetch" href="/documentacion-vue/assets/js/39.a564864f.js"><link rel="prefetch" href="/documentacion-vue/assets/js/4.cf868871.js"><link rel="prefetch" href="/documentacion-vue/assets/js/40.219d8fca.js"><link rel="prefetch" href="/documentacion-vue/assets/js/42.3dd20b5e.js"><link rel="prefetch" href="/documentacion-vue/assets/js/43.2589c9ad.js"><link rel="prefetch" href="/documentacion-vue/assets/js/44.27dfd3d5.js"><link rel="prefetch" href="/documentacion-vue/assets/js/45.ab5771c3.js"><link rel="prefetch" href="/documentacion-vue/assets/js/46.14fa8a39.js"><link rel="prefetch" href="/documentacion-vue/assets/js/47.a36f2c40.js"><link rel="prefetch" href="/documentacion-vue/assets/js/48.bcaa2d54.js"><link rel="prefetch" href="/documentacion-vue/assets/js/49.50b33290.js"><link rel="prefetch" href="/documentacion-vue/assets/js/5.16395e66.js"><link rel="prefetch" href="/documentacion-vue/assets/js/50.8c63af04.js"><link rel="prefetch" href="/documentacion-vue/assets/js/51.9a3b71b2.js"><link rel="prefetch" href="/documentacion-vue/assets/js/52.e2209c0c.js"><link rel="prefetch" href="/documentacion-vue/assets/js/53.2413b440.js"><link rel="prefetch" href="/documentacion-vue/assets/js/6.b82c7573.js"><link rel="prefetch" href="/documentacion-vue/assets/js/7.708cf71a.js"><link rel="prefetch" href="/documentacion-vue/assets/js/8.7ade18ae.js"><link rel="prefetch" href="/documentacion-vue/assets/js/9.0c4b7bc3.js">
    <link rel="stylesheet" href="/documentacion-vue/assets/css/0.styles.7d8547ba.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/documentacion-vue/" class="home-link router-link-active"><!----> <span class="site-name">Documentacion General !💻💻💻</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/documentacion-vue/pluralsight/" class="nav-link">
  PluralSight!📘📘
</a></div><div class="nav-item"><a href="/documentacion-vue/sqlserver/" class="nav-link">
  SQL!📘📘
</a></div><div class="nav-item"><a href="/documentacion-vue/javascript/" class="nav-link">
  JavaScript ! 💀💀💀
</a></div><div class="nav-item"><a href="/documentacion-vue/departamento/" class="nav-link">
  Cuentas Departamento 💵💵💵
</a></div><div class="nav-item"><a href="/documentacion-vue/guide/" class="nav-link router-link-active">
  Documentacion 😄
</a></div><div class="nav-item"><a href="https://github.com/sebarach" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Mi GitHub ! ❤️
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/documentacion-vue/pluralsight/" class="nav-link">
  PluralSight!📘📘
</a></div><div class="nav-item"><a href="/documentacion-vue/sqlserver/" class="nav-link">
  SQL!📘📘
</a></div><div class="nav-item"><a href="/documentacion-vue/javascript/" class="nav-link">
  JavaScript ! 💀💀💀
</a></div><div class="nav-item"><a href="/documentacion-vue/departamento/" class="nav-link">
  Cuentas Departamento 💵💵💵
</a></div><div class="nav-item"><a href="/documentacion-vue/guide/" class="nav-link router-link-active">
  Documentacion 😄
</a></div><div class="nav-item"><a href="https://github.com/sebarach" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Mi GitHub ! ❤️
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Documentacion</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Apuntes</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/documentacion-vue/guide/apuntes/" aria-current="page" class="sidebar-link">General</a></li><li><a href="/documentacion-vue/guide/apuntes/uai-sql.html" aria-current="page" class="active sidebar-link">Negocio SQL</a></li><li><a href="/documentacion-vue/guide/apuntes/encochinamiento.html" class="sidebar-link">Encochinamiento Objects</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="negocio-sql"><a href="#negocio-sql" class="header-anchor">#</a> Negocio SQL</h1> <hr> <ul><li>Configurar datos para habilitar inscripciones</li></ul> <ol><li>Setear Configuracion</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">update</span> InscripcionAsignatura_ConfiguracionInscripcionAsignatura
<span class="token keyword">set</span> FechaAvisoIntranetTermino<span class="token operator">=</span> FechaAvisoIntranetTermino <span class="token operator">+</span> <span class="token number">365</span><span class="token punctuation">,</span>FechaTermino <span class="token operator">=</span> FechaTermino <span class="token operator">+</span> <span class="token number">365</span><span class="token punctuation">,</span>IsActiva<span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">where</span> id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">284</span><span class="token punctuation">,</span><span class="token number">283</span><span class="token punctuation">)</span>
</code></pre></div><p>2- Buscar etapas y setear etapas</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> InscribeIngles<span class="token punctuation">,</span>InscribeExtraProgramatico<span class="token punctuation">,</span>EtapaActiva<span class="token punctuation">,</span><span class="token operator">*</span> <span class="token keyword">from</span> InscripcionAsignatura_EtapaInscripcionAsignatura 
<span class="token keyword">where</span> ConfiguracionInscripcionAsignaturaId <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">284</span><span class="token punctuation">,</span><span class="token number">283</span><span class="token punctuation">)</span> <span class="token operator">and</span> IsDeleted <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">update</span> InscripcionAsignatura_EtapaInscripcionAsignatura
<span class="token keyword">set</span> EtapaActiva <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>InscribeIngles <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>InscribeExtraProgramatico <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">where</span> id <span class="token operator">in</span><span class="token punctuation">(</span> <span class="token number">419</span><span class="token punctuation">,</span><span class="token number">420</span><span class="token punctuation">)</span>
</code></pre></div><p>3- Buscar grupos y setear grupos y ver alumnos por grupo</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> InscripcionAsignatura_GrupoInscripcionAsignatura 
<span class="token keyword">where</span> EtapaInscripcionAsignaturaId <span class="token operator">in</span><span class="token punctuation">(</span><span class="token number">419</span><span class="token punctuation">)</span> <span class="token operator">and</span> IsDeleted <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">update</span> InscripcionAsignatura_GrupoInscripcionAsignatura
<span class="token keyword">set</span> FechaTermino <span class="token operator">=</span> FechaTermino <span class="token operator">+</span> <span class="token number">365</span><span class="token punctuation">,</span>FechaInicio <span class="token operator">=</span> FechaInicio <span class="token operator">-</span> <span class="token number">365</span>
<span class="token keyword">where</span> EtapaInscripcionAsignaturaId <span class="token operator">in</span><span class="token punctuation">(</span><span class="token number">420</span><span class="token punctuation">)</span> <span class="token operator">and</span> IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
</code></pre></div><ul><li>El siguiente SP trae los nodos que se pintan los ramos extra</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code>spExpediente_Obtiene_PeriodosMallaExtraProgramaticos <span class="token number">77884</span><span class="token punctuation">,</span><span class="token number">419</span><span class="token punctuation">,</span><span class="token number">783</span> <span class="token comment">-- jmadero@alumnos.uai.cl</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> InscripcionAsignatura_ExpedienteGrupoLnk <span class="token keyword">where</span> GrupoInscripcionId <span class="token operator">=</span> <span class="token number">3190</span>

<span class="token keyword">select</span> ea<span class="token punctuation">.</span>Email<span class="token punctuation">,</span><span class="token operator">*</span> <span class="token keyword">from</span> Expediente_Expediente ee 
<span class="token keyword">join</span> Expediente_Alumno ea <span class="token keyword">on</span> ee<span class="token punctuation">.</span>AlumnoId <span class="token operator">=</span> ea<span class="token punctuation">.</span>id
<span class="token keyword">join</span> Common_Persona cp <span class="token keyword">on</span>  cp<span class="token punctuation">.</span>id <span class="token operator">=</span> ea<span class="token punctuation">.</span>PersonaId
<span class="token keyword">where</span> ee<span class="token punctuation">.</span>Id <span class="token operator">=</span> <span class="token number">77884</span>

</code></pre></div><hr> <hr> <ul><li>Reporte Syllabus,enviar qry a joaquin y el con un programa genera los pdf</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> B<span class="token punctuation">.</span>BinFile<span class="token punctuation">,</span>
    CAST<span class="token punctuation">(</span>
    cast <span class="token punctuation">(</span>PA<span class="token punctuation">.</span>Id <span class="token keyword">as</span> nvarchar<span class="token punctuation">(</span>MAX<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- PeriodoAcademicoId</span>
    <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span>
    cast <span class="token punctuation">(</span>S<span class="token punctuation">.</span>Id  <span class="token keyword">as</span> nvarchar<span class="token punctuation">(</span>MAX<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- IdSeccion</span>
    <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span>
    cast <span class="token punctuation">(</span>A<span class="token punctuation">.</span>Sigla  <span class="token keyword">as</span> nvarchar<span class="token punctuation">(</span>MAX<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- Sigla</span>
    <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span>
    <span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span>NA<span class="token punctuation">.</span>Nombre<span class="token punctuation">,</span><span class="token string">':'</span><span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'¿'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'\','</span> <span class="token string">'),'</span>?<span class="token string">',''),'</span><span class="token operator">/</span><span class="token string">','') -- NombreAsignatura
    + '</span><span class="token punctuation">.</span><span class="token string">' +
        case
            when DPS.Nombre is not null AND DPS.Nombre != '' then reverse(left(reverse(DPS.Nombre),charindex('</span><span class="token punctuation">.</span><span class="token string">',reverse(DPS.Nombre))-1))
            else reverse(left(reverse(DPS.NombreOriginal),charindex('</span><span class="token punctuation">.</span>'<span class="token punctuation">,</span>reverse<span class="token punctuation">(</span>DPS<span class="token punctuation">.</span>NombreOriginal<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>
     <span class="token keyword">AS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span>MAX<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> Name
<span class="token keyword">FROM</span> Planificacion_Seccion S
<span class="token keyword">JOIN</span> RegistrosAcademicos_DocumentoProgramaSeccion DPS <span class="token keyword">ON</span> DPS<span class="token punctuation">.</span>Id <span class="token operator">=</span> S<span class="token punctuation">.</span>DocumentoProgramaSeccionId <span class="token operator">AND</span> DPS<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> Common_Binario B <span class="token keyword">ON</span> B<span class="token punctuation">.</span>Id <span class="token operator">=</span> DPS<span class="token punctuation">.</span>BinarioId <span class="token operator">AND</span> B<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> Core_Asignatura A <span class="token keyword">ON</span> A<span class="token punctuation">.</span>Id <span class="token operator">=</span> S<span class="token punctuation">.</span>AsignaturaId <span class="token operator">AND</span> A<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> Core_NombreAsignatura NA <span class="token keyword">ON</span> NA<span class="token punctuation">.</span>Id <span class="token operator">=</span> S<span class="token punctuation">.</span>NombreAsignaturaId <span class="token operator">AND</span> NA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> Planificacion_PeriodoAcademico PA <span class="token keyword">on</span> PA<span class="token punctuation">.</span>id <span class="token operator">=</span> S<span class="token punctuation">.</span>PeriodoAcademicoId <span class="token operator">and</span> PA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span><span class="token number">0</span>  <span class="token operator">and</span> PA<span class="token punctuation">.</span>AnoPeriodo <span class="token operator">=</span> <span class="token number">2022</span>
<span class="token keyword">WHERE</span> S<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
</code></pre></div><ul><li>Reporte encuesta docente seccion configuracion ID</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">distinct</span> ink<span class="token punctuation">.</span>SeccionId<span class="token punctuation">,</span>casig<span class="token punctuation">.</span>Sigla<span class="token punctuation">,</span>psec<span class="token punctuation">.</span>DescripcionEspecifica<span class="token punctuation">,</span>venc<span class="token punctuation">.</span>NumeroVersion<span class="token punctuation">,</span>enc<span class="token punctuation">.</span>Nombre<span class="token punctuation">,</span>ce<span class="token punctuation">.</span>Id configuracionEncuesta 
<span class="token keyword">from</span> EncuestaDocente_ConfiguracionEncuestaDocente ce 
<span class="token keyword">join</span> EncuestaDocente_SeccionPlantillaEncuestaDocenteLnk ink <span class="token keyword">on</span> ink<span class="token punctuation">.</span>ConfiguracionEncuestaDocenteId <span class="token operator">=</span> ce<span class="token punctuation">.</span>Id <span class="token operator">and</span> ink<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">join</span> Encuesta_VersionEncuesta venc <span class="token keyword">on</span> ink<span class="token punctuation">.</span>VersionEncuestaDocenteId <span class="token operator">=</span> venc<span class="token punctuation">.</span>Id <span class="token operator">and</span> venc<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> Encuesta_Encuesta enc <span class="token keyword">on</span> venc<span class="token punctuation">.</span>EncuestaId <span class="token operator">=</span> enc<span class="token punctuation">.</span>Id <span class="token operator">and</span> enc<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> Planificacion_Seccion psec <span class="token keyword">on</span> ink<span class="token punctuation">.</span>SeccionId <span class="token operator">=</span> psec<span class="token punctuation">.</span>Id <span class="token operator">and</span> psec<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> Core_Asignatura casig <span class="token keyword">on</span> casig<span class="token punctuation">.</span>id <span class="token operator">=</span> psec<span class="token punctuation">.</span>AsignaturaId <span class="token operator">and</span> casig<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">where</span> ce<span class="token punctuation">.</span>id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">17889</span><span class="token punctuation">,</span><span class="token number">17890</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>Eliminar link de instructores seccion</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">declare</span> <span class="token variable">@existe</span> <span class="token keyword">int</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> <span class="token variable">@existe</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">Count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> PSED<span class="token punctuation">.</span>id<span class="token punctuation">)</span> Existe <span class="token keyword">from</span> Planificacion_Seccion S
<span class="token keyword">join</span> Planificacion_LinkSeccionInstructor LI <span class="token keyword">on</span> LI<span class="token punctuation">.</span>SeccionId <span class="token operator">=</span> S<span class="token punctuation">.</span>id <span class="token operator">and</span> LI<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> EncuestaDocente_PlantillaEncuestaDocente PED <span class="token keyword">on</span> PED<span class="token punctuation">.</span>SeccionId <span class="token operator">=</span> S<span class="token punctuation">.</span>Id <span class="token operator">and</span> PED<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> EncuestaDocente_PlantillaSeccionEncuestaDocente PSED <span class="token keyword">on</span> PSED<span class="token punctuation">.</span>PlantillaEncuestaDocenteId <span class="token operator">=</span> PED<span class="token punctuation">.</span>Id <span class="token operator">and</span> PSED<span class="token punctuation">.</span>InstructorId <span class="token operator">=</span> LI<span class="token punctuation">.</span>InstructorId <span class="token operator">and</span> PSED<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">where</span> S<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">81486</span>
<span class="token operator">AND</span> PSED<span class="token punctuation">.</span>InstructorId <span class="token operator">=</span> <span class="token number">14857</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">@existe</span> <span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
<span class="token keyword">print</span><span class="token string">'Tiene encuesta asociada'</span> <span class="token keyword">end</span>
<span class="token keyword">else</span> <span class="token keyword">begin</span>
<span class="token keyword">update</span> Planificacion_LinkSeccionInstructor
<span class="token keyword">set</span> IsDeleted <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>FechaModificacion <span class="token operator">=</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>UsuarioIdModificacion <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">123894</span>
<span class="token keyword">end</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> omegapm<span class="token punctuation">.</span><span class="token punctuation">.</span>markedobjects
<span class="token keyword">select</span> <span class="token keyword">distinct</span> S<span class="token punctuation">.</span>ServerId<span class="token punctuation">,</span> <span class="token string">'OMEGACore.Model.Planificacion.Seccion'</span><span class="token punctuation">,</span> ex<span class="token punctuation">.</span>id 
<span class="token keyword">from</span> omegapm<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>Servers S<span class="token punctuation">,</span> Planificacion_Seccion ex  <span class="token keyword">with</span><span class="token punctuation">(</span>nolock<span class="token punctuation">)</span>
<span class="token keyword">where</span> S<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">and</span> ex<span class="token punctuation">.</span>Id <span class="token operator">=</span> <span class="token number">81486</span>
</code></pre></div><ul><li>eximir de ingles segun archivo enviado por excel</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token comment">#Ingles (Id int,</span>
                      Eximir_desde <span class="token keyword">varchar</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">,</span>
                      Eximir_hasta <span class="token keyword">varchar</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">,</span>
                     <span class="token punctuation">)</span>
<span class="token comment">--cargamos los datos enviados en una tabla temporal</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token comment">#Ingles select 89183,'ENG001','ENG008'</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token comment">#Ingles select 89068,'ENG001','ENG008'</span>

    <span class="token keyword">select</span> ex<span class="token punctuation">.</span>id expedienteid<span class="token punctuation">,</span>
    a<span class="token punctuation">.</span>id asignaturaid<span class="token punctuation">,</span>
    NM<span class="token punctuation">.</span>Id NodoMallaId<span class="token punctuation">,</span>
    <span class="token number">7</span> Nota<span class="token punctuation">,</span> 
    <span class="token string">'Ex. 2022-1'</span> Descripcion<span class="token punctuation">,</span>
    GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span> FechaEximicion<span class="token punctuation">,</span>
    <span class="token number">0</span> IsAnulada<span class="token punctuation">,</span>
    <span class="token number">1</span> UsuarioIdCreacion<span class="token punctuation">,</span>
    getdate<span class="token punctuation">(</span><span class="token punctuation">)</span> FechaCreacion<span class="token punctuation">,</span>
    <span class="token number">1</span> UsuarioIdModificacion<span class="token punctuation">,</span>
    getdate<span class="token punctuation">(</span><span class="token punctuation">)</span> FechaModificacion<span class="token punctuation">,</span>
    <span class="token number">0</span> IsDeleted<span class="token punctuation">,</span>
    A<span class="token punctuation">.</span>NombreAsignaturaVigenteId NombreAsignaturaId<span class="token punctuation">,</span>
   <span class="token boolean">null</span> IsAnuladoOmega
    <span class="token keyword">into</span> <span class="token comment">#nodoMallaEng</span>
    <span class="token keyword">from</span> Expediente_Expediente ex
    <span class="token keyword">inner</span> <span class="token keyword">join</span> Expediente_ExpedienteVersionExtraProgramaticoLnk evpl <span class="token keyword">on</span> ex<span class="token punctuation">.</span>id<span class="token operator">=</span>evpl<span class="token punctuation">.</span>ExpedienteId
                                                        <span class="token operator">and</span> evpl<span class="token punctuation">.</span>IsDeleted<span class="token operator">=</span><span class="token number">0</span>
                                                        <span class="token operator">and</span> evpl<span class="token punctuation">.</span>IsAnulada<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">inner</span> <span class="token keyword">join</span> PlanEstudio_PeriodoMalla pm <span class="token keyword">on</span> evpl<span class="token punctuation">.</span>VersionPlanEstudioId<span class="token operator">=</span>pm<span class="token punctuation">.</span>VersionPlanEstudioId
                                        <span class="token operator">and</span> pm<span class="token punctuation">.</span>IsDeleted<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">inner</span> <span class="token keyword">join</span> PlanEstudio_NodoMalla NM <span class="token keyword">on</span> NM<span class="token punctuation">.</span>PeriodoMallaId <span class="token operator">=</span> PM<span class="token punctuation">.</span>Id <span class="token operator">and</span> NM<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">and</span> NM<span class="token punctuation">.</span>TipoAsignatura <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token keyword">inner</span> <span class="token keyword">join</span> PlanEstudio_NodoMallaAsignatura NMA <span class="token keyword">on</span> NMa<span class="token punctuation">.</span>NodoMallaId <span class="token operator">=</span> NM<span class="token punctuation">.</span>Id <span class="token operator">and</span> NMA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">inner</span> <span class="token keyword">join</span> Core_Asignatura A <span class="token keyword">on</span> A<span class="token punctuation">.</span>Id <span class="token operator">=</span> NMA<span class="token punctuation">.</span>AsignaturaId
    <span class="token keyword">inner</span> <span class="token keyword">join</span> <span class="token comment">#Ingles temp on ex.id=temp.id</span>
    <span class="token keyword">where</span>  a<span class="token punctuation">.</span>sigla  <span class="token operator">like</span> <span class="token string">'%ENG%'</span>
    <span class="token operator">and</span> cast<span class="token punctuation">(</span>substring<span class="token punctuation">(</span>a<span class="token punctuation">.</span>Sigla<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> cast<span class="token punctuation">(</span>substring<span class="token punctuation">(</span>Eximir_hasta<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">int</span><span class="token punctuation">)</span>
    <span class="token keyword">order</span> <span class="token keyword">by</span> ex<span class="token punctuation">.</span>id <span class="token keyword">desc</span>

    <span class="token keyword">insert</span> <span class="token keyword">into</span> Expediente_Eximicion
    <span class="token keyword">select</span>  expedienteid<span class="token punctuation">,</span>
     asignaturaid<span class="token punctuation">,</span>
    NodoMallaId<span class="token punctuation">,</span>
     Nota<span class="token punctuation">,</span>
     Descripcion<span class="token punctuation">,</span>
    FechaEximicion<span class="token punctuation">,</span>
    IsAnulada<span class="token punctuation">,</span>
     UsuarioIdCreacion<span class="token punctuation">,</span>
    FechaCreacion<span class="token punctuation">,</span>
     UsuarioIdModificacion<span class="token punctuation">,</span>
     FechaModificacion<span class="token punctuation">,</span>
    IsDeleted<span class="token punctuation">,</span>
    NombreAsignaturaId<span class="token punctuation">,</span>
	IsAnuladoOmega
    <span class="token keyword">from</span> <span class="token comment">#nodoMallaEng</span>


    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> omegapm<span class="token punctuation">.</span><span class="token punctuation">.</span>markedobjects
    <span class="token keyword">SELECT</span> <span class="token keyword">distinct</span> serverid<span class="token punctuation">,</span> <span class="token string">'OMEGACore.Model.Expediente.Eximicion'</span><span class="token punctuation">,</span>Ex<span class="token punctuation">.</span>Id
    <span class="token keyword">FROM</span> omegapm<span class="token punctuation">.</span><span class="token punctuation">.</span>servers S<span class="token punctuation">,</span> Expediente_Eximicion Ex
    <span class="token keyword">WHERE</span> S<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token operator">and</span> Ex<span class="token punctuation">.</span>ExpedienteId <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> Id <span class="token keyword">from</span> <span class="token comment">#Ingles)</span>
    <span class="token operator">and</span> NombreAsignaturaId <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">select</span> NombreAsignaturaId <span class="token keyword">from</span> <span class="token comment">#nodoMallaEng)</span>


    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> omegapm<span class="token punctuation">.</span><span class="token punctuation">.</span>markedobjects
    <span class="token keyword">SELECT</span> <span class="token keyword">distinct</span> serverid<span class="token punctuation">,</span> <span class="token string">'OMEGACore.Model.Expediente.Expediente'</span><span class="token punctuation">,</span>Ex<span class="token punctuation">.</span>id
    <span class="token keyword">FROM</span> omegapm<span class="token punctuation">.</span><span class="token punctuation">.</span>servers S<span class="token punctuation">,</span> Expediente_Expediente Ex
    <span class="token keyword">WHERE</span> S<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token operator">and</span> Ex<span class="token punctuation">.</span>id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> Id <span class="token keyword">from</span> <span class="token comment">#Ingles)</span>

    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> omegapm<span class="token punctuation">.</span><span class="token punctuation">.</span>markedobjects
    <span class="token keyword">SELECT</span> serverid<span class="token punctuation">,</span> <span class="token string">'OMEGACore.Model.Expediente.Alumno'</span><span class="token punctuation">,</span>Ex<span class="token punctuation">.</span>id
    <span class="token keyword">FROM</span> omegapm<span class="token punctuation">.</span><span class="token punctuation">.</span>servers S<span class="token punctuation">,</span> Expediente_Alumno Ex
    <span class="token keyword">WHERE</span> S<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token operator">and</span> Ex<span class="token punctuation">.</span>id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> ee<span class="token punctuation">.</span>AlumnoId <span class="token keyword">from</span> <span class="token comment">#Ingles tmp join Expediente_Expediente ee on tmp.id = ee.Id)</span>

    <span class="token keyword">insert</span> <span class="token keyword">into</span> omegalog<span class="token punctuation">.</span><span class="token punctuation">.</span>Expediente_Eximicion 
    <span class="token keyword">select</span> exe<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> Expediente_Eximicion exe
    <span class="token keyword">inner</span> <span class="token keyword">join</span> <span class="token comment">#nodoMallaEng nm on exe.expedienteid = nm.expedienteid and exe.nodomallaid = nm.nodomallaid and exe.IsDeleted =0 and exe.UsuarioIdCreacion = 1</span>
</code></pre></div><ul><li>Corregir encuestas y plantillas</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">--buscar las conf que fueron eliminadas</span>
<span class="token comment">--setear el punt de conf de e. a 0 en las secciones</span>
<span class="token keyword">update</span> Planificacion_Seccion
<span class="token keyword">set</span> ConfiguracionEncuestaDocenteId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>FechaModificacion <span class="token operator">=</span> GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>UsuarioIdModificacion <span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">where</span> id <span class="token operator">in</span> <span class="token punctuation">(</span>
<span class="token keyword">select</span> id <span class="token keyword">from</span> Planificacion_Seccion <span class="token keyword">where</span> ConfiguracionEncuestaDocenteId <span class="token operator">in</span><span class="token punctuation">(</span><span class="token number">27834</span><span class="token punctuation">,</span><span class="token number">17789</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment">--eliminar de esta tabla tambien para poder agregar las secciones a otra conf</span>
<span class="token keyword">update</span> EncuestaDocente_SeccionPlantillaEncuestaDocenteLnk
<span class="token keyword">set</span> IsDeleted <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">where</span> ConfiguracionEncuestaDocenteId <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">27834</span><span class="token punctuation">,</span><span class="token number">17789</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>Creacion de Encuestas Profesores</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Omega_EncuestaOmegaVersion<span class="token punctuation">]</span> <span class="token comment">-- Crear version 2021 Asociado a encuestaid=3</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token punctuation">[</span>Omega_EncuestaOmegaVersion<span class="token punctuation">]</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'Encuesta de Transferencia de Investigación a la Docencia 2021'</span><span class="token punctuation">)</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token punctuation">[</span>Omega_EncuestaOmegaVersion<span class="token punctuation">]</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'Encuesta Área Investigación 2021'</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Omega_EncuestaOmegaPoblacion<span class="token punctuation">]</span> <span class="token comment">-- Se debe crear una nueva población y asociaro a la tabla Omega_EncuestaOmegaVersion</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token punctuation">[</span>Omega_EncuestaOmegaPoblacion<span class="token punctuation">]</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'Encuesta de Transferencia de Investigación a la Docencia 2021'</span><span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token punctuation">[</span>Omega_EncuestaOmegaPoblacion<span class="token punctuation">]</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'Encuesta Área Investigación 2021'</span><span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Omega_EncuestaOmegaPoblacionUsuarios<span class="token punctuation">]</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">1</span> <span class="token keyword">desc</span><span class="token comment">-- where UsuarioId = 2449 --  mario.vergara@uai.cl</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token punctuation">[</span>Omega_EncuestaOmegaPoblacionUsuarios<span class="token punctuation">]</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">2449</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">--  mario.vergara@uai.cl</span>
</code></pre></div><ul><li>Cantidad de inscripciones por Expediente</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> CP<span class="token punctuation">.</span>NOMBRE NOMBRE<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>ApellidoPaterno<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>RUT RUT<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>DigitoVerificador DV<span class="token punctuation">,</span> ink<span class="token punctuation">.</span>ExpedienteId<span class="token punctuation">,</span>
<span class="token function">COUNT</span><span class="token punctuation">(</span>INK<span class="token punctuation">.</span>ExpedienteId<span class="token punctuation">)</span> TOTAL_INSCRIPCIONES<span class="token punctuation">,</span> <span class="token comment">-- todas las inscripciones del período</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> isnull<span class="token punctuation">(</span>EI<span class="token punctuation">.</span>EtapaInscripcionAsignaturaId<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">351</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span> INSCRIPCIONES_PROCESO<span class="token punctuation">,</span> <span class="token comment">-- las inscripciones hechas por sistema de toma de ramos</span>
 grup<span class="token punctuation">.</span>Numero NumeroGrupo<span class="token punctuation">,</span>grup<span class="token punctuation">.</span>EtapaInscripcionAsignaturaId Etapa<span class="token punctuation">,</span> <span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>grup<span class="token punctuation">.</span>FechaInicio<span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span> HoraGrupo
<span class="token keyword">from</span> Expediente_Expediente EE 
<span class="token keyword">JOIN</span> Expediente_Alumno EA <span class="token keyword">ON</span> EE<span class="token punctuation">.</span>AlumnoId <span class="token operator">=</span> EA<span class="token punctuation">.</span>Id
<span class="token keyword">JOIN</span> Common_Persona CP <span class="token keyword">ON</span> EA<span class="token punctuation">.</span>PersonaId <span class="token operator">=</span> CP<span class="token punctuation">.</span>Id
<span class="token keyword">JOIN</span> InscripcionAsignatura_ExpedienteGrupoLnk INK <span class="token keyword">ON</span> EE<span class="token punctuation">.</span>Id <span class="token operator">=</span> INK<span class="token punctuation">.</span>ExpedienteId <span class="token operator">and</span> INK<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> InscripcionAsignatura_GrupoInscripcionAsignatura grup <span class="token keyword">on</span> ink<span class="token punctuation">.</span>GrupoInscripcionId <span class="token operator">=</span> grup<span class="token punctuation">.</span>Id <span class="token operator">and</span> grup<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">and</span> grup<span class="token punctuation">.</span>EtapaInscripcionAsignaturaId <span class="token operator">=</span> <span class="token number">351</span> 
<span class="token keyword">left</span> <span class="token keyword">join</span> Expediente_Inscripcion EI <span class="token keyword">on</span> EI<span class="token punctuation">.</span>ExpedienteId <span class="token operator">=</span> EE<span class="token punctuation">.</span>id <span class="token operator">AND</span> EI<span class="token punctuation">.</span>IsAnulada <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">AND</span> EI<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment">--and EI.EtapaInscripcionAsignaturaId = 351 </span>
<span class="token keyword">left</span> <span class="token keyword">join</span> Planificacion_Seccion SS <span class="token keyword">on</span> SS<span class="token punctuation">.</span>id <span class="token operator">=</span> EI<span class="token punctuation">.</span>SeccionId <span class="token operator">and</span> SS<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">and</span> SS<span class="token punctuation">.</span>PeriodoAcademicoId <span class="token operator">=</span> <span class="token number">3169</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> INK<span class="token punctuation">.</span>Id<span class="token punctuation">,</span>ink<span class="token punctuation">.</span>ExpedienteId<span class="token punctuation">,</span>grup<span class="token punctuation">.</span>Numero<span class="token punctuation">,</span>grup<span class="token punctuation">.</span>EtapaInscripcionAsignaturaId<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>NOMBRE<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>RUT<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>DigitoVerificador<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>ApellidoPaterno<span class="token punctuation">,</span> grup<span class="token punctuation">.</span>FechaInicio
<span class="token keyword">order</span> <span class="token keyword">by</span> grup<span class="token punctuation">.</span>Numero
</code></pre></div><ul><li>Total Por Grupo</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> grup<span class="token punctuation">.</span>Numero<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> EE<span class="token punctuation">.</span>id<span class="token punctuation">)</span> Q_Expedientes<span class="token punctuation">,</span>   
<span class="token function">COUNT</span><span class="token punctuation">(</span>INK<span class="token punctuation">.</span>ExpedienteId<span class="token punctuation">)</span> TOTAL_INSCRIPCIONES<span class="token punctuation">,</span> <span class="token comment">-- todas las inscripciones del período</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> isnull<span class="token punctuation">(</span>EI<span class="token punctuation">.</span>EtapaInscripcionAsignaturaId<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">351</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span> INSCRIPCIONES_PROCESO <span class="token comment">-- las inscripciones hechas por sistema de toma de ramos</span>
<span class="token keyword">from</span> Expediente_Expediente EE 
<span class="token keyword">JOIN</span> Expediente_Alumno EA <span class="token keyword">ON</span> EE<span class="token punctuation">.</span>AlumnoId <span class="token operator">=</span> EA<span class="token punctuation">.</span>Id
<span class="token keyword">JOIN</span> Common_Persona CP <span class="token keyword">ON</span> EA<span class="token punctuation">.</span>PersonaId <span class="token operator">=</span> CP<span class="token punctuation">.</span>Id
<span class="token keyword">JOIN</span> InscripcionAsignatura_ExpedienteGrupoLnk INK <span class="token keyword">ON</span> EE<span class="token punctuation">.</span>Id <span class="token operator">=</span> INK<span class="token punctuation">.</span>ExpedienteId <span class="token operator">and</span> INK<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> InscripcionAsignatura_GrupoInscripcionAsignatura grup <span class="token keyword">on</span> ink<span class="token punctuation">.</span>GrupoInscripcionId <span class="token operator">=</span> grup<span class="token punctuation">.</span>Id <span class="token operator">and</span> grup<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">and</span> grup<span class="token punctuation">.</span>EtapaInscripcionAsignaturaId <span class="token operator">=</span> <span class="token number">351</span> 
<span class="token keyword">left</span> <span class="token keyword">join</span> Expediente_Inscripcion EI <span class="token keyword">on</span> EI<span class="token punctuation">.</span>ExpedienteId <span class="token operator">=</span> EE<span class="token punctuation">.</span>id <span class="token operator">AND</span> EI<span class="token punctuation">.</span>IsAnulada <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">AND</span> EI<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">--and EI.EtapaInscripcionAsignaturaId = 351 </span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> grup<span class="token punctuation">.</span>Numero
<span class="token keyword">order</span> <span class="token keyword">by</span> grup<span class="token punctuation">.</span>Numero
</code></pre></div><ul><li>setear columnas de la misma tabla</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">update</span> t1
<span class="token keyword">set</span> t1<span class="token punctuation">.</span>Edificio <span class="token operator">=</span> <span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">,</span>tmp<span class="token punctuation">.</span>edificio<span class="token punctuation">)</span><span class="token punctuation">,</span>t1<span class="token punctuation">.</span>UsuarioIdModificacion <span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">,</span> t1<span class="token punctuation">.</span>FechaModificacion <span class="token operator">=</span> GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Planificacion_Seccion t1
<span class="token keyword">join</span> <span class="token comment">#TMP tmp ON TMP.id = t1.Id</span>
</code></pre></div><ul><li>Reporte de ayudantes</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token comment">--i.id,pa.id,pa.AnoPeriodo,pa.NumeroPeriodo,</span>
p<span class="token punctuation">.</span>id<span class="token punctuation">,</span> p<span class="token punctuation">.</span>rut RutAyudante<span class="token punctuation">,</span> p<span class="token punctuation">.</span>Nombre NombreAyudante<span class="token punctuation">,</span> p<span class="token punctuation">.</span>ApellidoPaterno ApellidoPaternoAyudante<span class="token punctuation">,</span> p<span class="token punctuation">.</span>ApellidoMaterno ApellidoMaternoAyudante<span class="token punctuation">,</span> 
<span class="token keyword">case</span> <span class="token keyword">when</span> a<span class="token punctuation">.</span>Email <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token keyword">then</span> p<span class="token punctuation">.</span>EmailUai <span class="token keyword">else</span> a<span class="token punctuation">.</span>Email <span class="token keyword">end</span> EmailUaiAyudante<span class="token punctuation">,</span>
p<span class="token punctuation">.</span>Email CorreoPersonal
<span class="token keyword">from</span> Planificacion_Seccion s
<span class="token keyword">inner</span> <span class="token keyword">join</span> Planificacion_PeriodoAcademico PA <span class="token keyword">on</span> pa<span class="token punctuation">.</span>id<span class="token operator">=</span>s<span class="token punctuation">.</span>PeriodoAcademicoId <span class="token operator">and</span> pa<span class="token punctuation">.</span>UnidadAcademicaId <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">and</span> pa<span class="token punctuation">.</span>IsDeleted<span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">inner</span> <span class="token keyword">join</span> Planificacion_LinkSeccionInstructor LSI <span class="token keyword">on</span> LSI<span class="token punctuation">.</span>SeccionId<span class="token operator">=</span>s<span class="token punctuation">.</span>id <span class="token operator">and</span> LSI<span class="token punctuation">.</span>IsDeleted<span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">inner</span> <span class="token keyword">join</span> Planificacion_Instructor I <span class="token keyword">on</span> lsi<span class="token punctuation">.</span>InstructorId<span class="token operator">=</span>i<span class="token punctuation">.</span>id <span class="token operator">and</span> i<span class="token punctuation">.</span>IsDeleted<span class="token operator">=</span><span class="token number">0</span> <span class="token operator">and</span> i<span class="token punctuation">.</span>TipoRolId<span class="token operator">=</span><span class="token number">5</span>
<span class="token keyword">inner</span> <span class="token keyword">join</span> common_persona p <span class="token keyword">on</span> p<span class="token punctuation">.</span>id<span class="token operator">=</span>i<span class="token punctuation">.</span>PersonaId <span class="token operator">and</span> p<span class="token punctuation">.</span>IsDeleted<span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">left</span> <span class="token keyword">join</span> Expediente_Alumno a <span class="token keyword">on</span> a<span class="token punctuation">.</span>PersonaId<span class="token operator">=</span>p<span class="token punctuation">.</span>id <span class="token operator">and</span> a<span class="token punctuation">.</span>IsDeleted<span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">where</span> pa<span class="token punctuation">.</span>id<span class="token operator">&gt;=</span><span class="token number">3150</span> <span class="token comment">-- periodo academico</span>
<span class="token operator">and</span> s<span class="token punctuation">.</span>IsDeleted<span class="token operator">=</span><span class="token number">0</span>
<span class="token comment">--y que el ayudante no haya sido ayudante antes en cualquier periodo anterior al 2021</span>
<span class="token operator">and</span> <span class="token operator">not</span> <span class="token keyword">exists</span> <span class="token punctuation">(</span><span class="token keyword">select</span> i<span class="token punctuation">.</span>id
                <span class="token keyword">from</span> Planificacion_Seccion sx
                <span class="token keyword">inner</span> <span class="token keyword">join</span> Planificacion_PeriodoAcademico PAx <span class="token keyword">on</span> pax<span class="token punctuation">.</span>id<span class="token operator">=</span>sx<span class="token punctuation">.</span>PeriodoAcademicoId <span class="token operator">and</span> pax<span class="token punctuation">.</span>IsDeleted<span class="token operator">=</span><span class="token number">0</span>
                <span class="token keyword">inner</span> <span class="token keyword">join</span> Planificacion_LinkSeccionInstructor LSIx <span class="token keyword">on</span> LSIx<span class="token punctuation">.</span>SeccionId<span class="token operator">=</span>sx<span class="token punctuation">.</span>id <span class="token operator">and</span> LSIx<span class="token punctuation">.</span>IsDeleted<span class="token operator">=</span><span class="token number">0</span>
                <span class="token keyword">inner</span> <span class="token keyword">join</span> Planificacion_Instructor Ix <span class="token keyword">on</span> lsix<span class="token punctuation">.</span>InstructorId<span class="token operator">=</span>ix<span class="token punctuation">.</span>id <span class="token operator">and</span> ix<span class="token punctuation">.</span>IsDeleted<span class="token operator">=</span><span class="token number">0</span> <span class="token operator">and</span> ix<span class="token punctuation">.</span>TipoRolId<span class="token operator">=</span><span class="token number">5</span>
                <span class="token keyword">where</span> pax<span class="token punctuation">.</span>id<span class="token operator">&lt;=</span><span class="token number">3150</span> 
                <span class="token operator">and</span> sx<span class="token punctuation">.</span>IsDeleted<span class="token operator">=</span><span class="token number">0</span>
                <span class="token operator">and</span> ix<span class="token punctuation">.</span>id<span class="token operator">=</span>i<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
</code></pre></div><ul><li>Administracion DBA -- REVISAR BLOQUEOS</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> session_id <span class="token punctuation">,</span><span class="token keyword">status</span> <span class="token punctuation">,</span>blocking_session_id<span class="token punctuation">,</span>
wait_type <span class="token punctuation">,</span>wait_time <span class="token punctuation">,</span>wait_resource <span class="token punctuation">,</span>transaction_id 
<span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>dm_exec_requests <span class="token keyword">WHERE</span> <span class="token keyword">status</span> <span class="token operator">=</span> N<span class="token string">'suspended'</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> session_id<span class="token punctuation">,</span> wait_duration_ms<span class="token punctuation">,</span> wait_type<span class="token punctuation">,</span> blocking_session_id 
<span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>dm_os_waiting_tasks <span class="token keyword">WHERE</span> blocking_session_id <span class="token operator">&lt;&gt;</span> <span class="token number">0</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>dm_exec_sessions <span class="token keyword">WHERE</span> session_id <span class="token operator">=</span> <span class="token number">71</span>
</code></pre></div><ul><li>Reporte de Notas</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> ps<span class="token punctuation">.</span>Id IdSeccion<span class="token punctuation">,</span>
ASIG<span class="token punctuation">.</span>Sigla SIGLA<span class="token punctuation">,</span>
NASIG<span class="token punctuation">.</span>Nombre NOMBRE<span class="token punctuation">,</span>
PS<span class="token punctuation">.</span>NumeroSeccion NumeroSeccion<span class="token punctuation">,</span>
ua<span class="token punctuation">.</span>Nombre UnidadAcademica<span class="token punctuation">,</span>
ee<span class="token punctuation">.</span>Id IdExpediente<span class="token punctuation">,</span>
CP<span class="token punctuation">.</span>Rut RUT<span class="token punctuation">,</span>
CP<span class="token punctuation">.</span>DigitoVerificador DIGITO<span class="token punctuation">,</span>
CP<span class="token punctuation">.</span>Nombre<span class="token punctuation">,</span>
CP<span class="token punctuation">.</span>ApellidoPaterno<span class="token punctuation">,</span>
CP<span class="token punctuation">.</span>ApellidoMaterno<span class="token punctuation">,</span>
IE<span class="token punctuation">.</span>Nombre<span class="token punctuation">,</span>
CAL<span class="token punctuation">.</span>Nota
<span class="token keyword">from</span> Expediente_Expediente EE
<span class="token keyword">JOIN</span> Expediente_Alumno EA <span class="token keyword">ON</span> EE<span class="token punctuation">.</span>AlumnoId <span class="token operator">=</span> EA<span class="token punctuation">.</span>Id <span class="token operator">AND</span> EA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span> 
<span class="token keyword">JOIN</span> Common_Persona CP <span class="token keyword">ON</span> EA<span class="token punctuation">.</span>PersonaId <span class="token operator">=</span>CP<span class="token punctuation">.</span>Id <span class="token operator">AND</span> CP<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> Expediente_Inscripcion EI <span class="token keyword">ON</span> EE<span class="token punctuation">.</span>Id <span class="token operator">=</span> EI<span class="token punctuation">.</span>ExpedienteId <span class="token operator">AND</span> EI<span class="token punctuation">.</span>IsAnulada <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">AND</span> EI<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> Planificacion_Seccion PS <span class="token keyword">ON</span> EI<span class="token punctuation">.</span>SeccionId <span class="token operator">=</span> PS<span class="token punctuation">.</span>Id <span class="token operator">AND</span> PS<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> Core_Asignatura ASIG <span class="token keyword">ON</span> PS<span class="token punctuation">.</span>AsignaturaId <span class="token operator">=</span> ASIG<span class="token punctuation">.</span>Id <span class="token operator">AND</span> ASIG<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Core_NombreAsignatura NASIG <span class="token keyword">ON</span> ASIG<span class="token punctuation">.</span>NombreAsignaturaVigenteId <span class="token operator">=</span> NASIG<span class="token punctuation">.</span>ID
<span class="token keyword">JOIN</span> Planificacion_PeriodoAcademico PA <span class="token keyword">ON</span> PS<span class="token punctuation">.</span>PeriodoAcademicoId <span class="token operator">=</span> PA<span class="token punctuation">.</span>Id <span class="token operator">AND</span> PS<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span><span class="token number">0</span> 
<span class="token keyword">join</span> Core_UnidadAcademica UA <span class="token keyword">ON</span> PA<span class="token punctuation">.</span>UnidadAcademicaId <span class="token operator">=</span> UA<span class="token punctuation">.</span>Id <span class="token operator">AND</span> UA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> RegistrosAcademicos_InstrumentoEvaluacion IE <span class="token keyword">ON</span> PS<span class="token punctuation">.</span>Id <span class="token operator">=</span> EI<span class="token punctuation">.</span>SeccionId <span class="token operator">AND</span> IE<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> RegistrosAcademicos_Calificacion CAL <span class="token keyword">ON</span> IE<span class="token punctuation">.</span>Id <span class="token operator">=</span> CAL<span class="token punctuation">.</span>InstrumentoEvaluacionId <span class="token operator">AND</span> CAL<span class="token punctuation">.</span>InscripcionId <span class="token operator">=</span> EI<span class="token punctuation">.</span>Id <span class="token operator">AND</span> CAL<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">WHERE</span> PA<span class="token punctuation">.</span>Id <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">2755</span><span class="token punctuation">,</span><span class="token number">2782</span><span class="token punctuation">)</span> <span class="token operator">AND</span> EE<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">--and cp.Rut = 19908308</span>
<span class="token operator">AND</span> UA<span class="token punctuation">.</span>Id <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>Usar columnas de excel para hacer tablas temporales</li></ul> <div class="language-xlsx extra-class"><pre class="language-xlsx"><code>create table #<span class="token function-name keyword">tmp</span><span class="token punctuation">(</span>idExpCarrera int<span class="token operator">,</span>IdCombinacion int<span class="token operator">,</span>IdReglamento int<span class="token punctuation">)</span>
insert into #tmp <span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token operator">&amp;</span><span class="token cell property">B2</span><span class="token operator">&amp;</span><span class="token string">&quot;,&quot;</span><span class="token operator">&amp;</span><span class="token cell property">C2</span><span class="token operator">&amp;</span><span class="token string">&quot;,&quot;</span><span class="token operator">&amp;</span><span class="token cell property">D2</span><span class="token operator">&amp;</span><span class="token string">&quot;&quot;</span>
</code></pre></div><ul><li>Reporte encuesta de investigacion</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> UsuarioId<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>EmailUai<span class="token punctuation">,</span><span class="token string">'Si'</span> Contesto <span class="token keyword">from</span> Omega_EncuestaOmegaPoblacionUsuarios EP
<span class="token keyword">JOIN</span> Seguridad_Usuario SU <span class="token keyword">ON</span> EP<span class="token punctuation">.</span>UsuarioId <span class="token operator">=</span> SU<span class="token punctuation">.</span>Id <span class="token operator">AND</span> SU<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> Common_Persona CP <span class="token keyword">ON</span> SU<span class="token punctuation">.</span>PersonaId <span class="token operator">=</span> CP<span class="token punctuation">.</span>Id
<span class="token keyword">WHERE</span> EP<span class="token punctuation">.</span>UsuarioId  <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> usuarioid <span class="token keyword">from</span> Omega_EscuestaOmegaProfesores <span class="token keyword">where</span> VersionId <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token operator">AND</span> EP<span class="token punctuation">.</span>PoblacionId <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> UsuarioId<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>EmailUai<span class="token punctuation">,</span><span class="token string">'No'</span> Contesto <span class="token keyword">from</span> Omega_EncuestaOmegaPoblacionUsuarios EP
<span class="token keyword">JOIN</span> Seguridad_Usuario SU <span class="token keyword">ON</span> EP<span class="token punctuation">.</span>UsuarioId <span class="token operator">=</span> SU<span class="token punctuation">.</span>Id <span class="token operator">AND</span> SU<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> Common_Persona CP <span class="token keyword">ON</span> SU<span class="token punctuation">.</span>PersonaId <span class="token operator">=</span> CP<span class="token punctuation">.</span>Id
<span class="token keyword">WHERE</span> EP<span class="token punctuation">.</span>UsuarioId <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> usuarioid <span class="token keyword">from</span> Omega_EscuestaOmegaProfesores <span class="token keyword">where</span> VersionId <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token operator">AND</span> EP<span class="token punctuation">.</span>PoblacionId <span class="token operator">=</span> <span class="token number">10</span>
</code></pre></div><ul><li>Obtiene horario inscripciones segun alumno id</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span>  ep<span class="token punctuation">.</span>Id idExpediente<span class="token punctuation">,</span>ip<span class="token punctuation">.</span>Id idInscripcion<span class="token punctuation">,</span>hs<span class="token punctuation">.</span>Id horarioSeccion<span class="token punctuation">,</span>dbo<span class="token punctuation">.</span>fnObtiene_HoraHorarioSeccion<span class="token punctuation">(</span>mo<span class="token punctuation">.</span>HoraInicio<span class="token punctuation">)</span>Inicio<span class="token punctuation">,</span>dbo<span class="token punctuation">.</span>fnObtiene_HoraHorarioSeccion<span class="token punctuation">(</span>mo<span class="token punctuation">.</span>HoraTermino<span class="token punctuation">)</span>Termino<span class="token punctuation">,</span>hs<span class="token punctuation">.</span>DiaSemana<span class="token punctuation">,</span>se<span class="token punctuation">.</span>Id seccionId<span class="token punctuation">,</span>hs<span class="token punctuation">.</span>FechaModificacion<span class="token punctuation">,</span>hs<span class="token punctuation">.</span>UsuarioIdModificacion
<span class="token keyword">from</span> Expediente_Inscripcion IP <span class="token keyword">with</span> <span class="token punctuation">(</span>nolock<span class="token punctuation">)</span> 
<span class="token keyword">join</span> Expediente_Expediente ep <span class="token keyword">with</span> <span class="token punctuation">(</span>nolock<span class="token punctuation">)</span> <span class="token keyword">on</span> ep<span class="token punctuation">.</span>Id <span class="token operator">=</span> IP<span class="token punctuation">.</span>ExpedienteId <span class="token operator">and</span> ep<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> Expediente_Alumno al <span class="token keyword">with</span> <span class="token punctuation">(</span>nolock<span class="token punctuation">)</span> <span class="token keyword">on</span> al<span class="token punctuation">.</span>Id <span class="token operator">=</span> ep<span class="token punctuation">.</span>AlumnoId <span class="token operator">and</span> al<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> Planificacion_Seccion se <span class="token keyword">with</span> <span class="token punctuation">(</span>nolock<span class="token punctuation">)</span> <span class="token keyword">on</span> se<span class="token punctuation">.</span>Id <span class="token operator">=</span> ip<span class="token punctuation">.</span>SeccionId <span class="token operator">and</span> se<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> Planificacion_HorarioSeccion hs <span class="token keyword">with</span> <span class="token punctuation">(</span>nolock<span class="token punctuation">)</span> <span class="token keyword">on</span> hs<span class="token punctuation">.</span>SeccionId <span class="token operator">=</span> se<span class="token punctuation">.</span>Id <span class="token operator">and</span> hs<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> Planificacion_ModuloUnidadAcademica mo <span class="token keyword">with</span> <span class="token punctuation">(</span>nolock<span class="token punctuation">)</span> <span class="token keyword">on</span> mo<span class="token punctuation">.</span>Id <span class="token operator">=</span> hs<span class="token punctuation">.</span>ModuloUnidadAcademicaId <span class="token operator">and</span> mo<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> Core_Asignatura asi <span class="token keyword">with</span> <span class="token punctuation">(</span>nolock<span class="token punctuation">)</span> <span class="token keyword">on</span> asi<span class="token punctuation">.</span>Id <span class="token operator">=</span> se<span class="token punctuation">.</span>AsignaturaId <span class="token operator">and</span> asi<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> Core_NombreAsignatura na <span class="token keyword">with</span> <span class="token punctuation">(</span>nolock<span class="token punctuation">)</span> <span class="token keyword">on</span> na<span class="token punctuation">.</span>Id <span class="token operator">=</span> asi<span class="token punctuation">.</span>NombreAsignaturaVigenteId <span class="token operator">and</span> na<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">left</span> <span class="token keyword">join</span> Planificacion_Instructor it <span class="token keyword">with</span> <span class="token punctuation">(</span>nolock<span class="token punctuation">)</span> <span class="token keyword">on</span> it<span class="token punctuation">.</span>Id <span class="token operator">=</span> se<span class="token punctuation">.</span>InstructorId <span class="token operator">and</span> it<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">left</span> <span class="token keyword">join</span> Common_Persona pe <span class="token keyword">with</span> <span class="token punctuation">(</span>nolock<span class="token punctuation">)</span> <span class="token keyword">on</span> pe<span class="token punctuation">.</span>Id <span class="token operator">=</span> it<span class="token punctuation">.</span>PersonaId <span class="token operator">and</span> pe<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">left</span> <span class="token keyword">join</span> Common_Sala sa <span class="token keyword">with</span> <span class="token punctuation">(</span>nolock<span class="token punctuation">)</span> <span class="token keyword">on</span> hs<span class="token punctuation">.</span>SalaId <span class="token operator">=</span> sa<span class="token punctuation">.</span>Id <span class="token operator">and</span> sa<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">where</span> al<span class="token punctuation">.</span>Id <span class="token operator">=</span> <span class="token number">59185</span>
<span class="token operator">and</span> ip<span class="token punctuation">.</span>Estado <span class="token operator">=</span> <span class="token number">3</span>
<span class="token operator">and</span> ip<span class="token punctuation">.</span>IsAnulada <span class="token operator">=</span> <span class="token number">0</span>
<span class="token operator">and</span> ip<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token operator">and</span> ep<span class="token punctuation">.</span>Estado <span class="token operator">=</span> <span class="token number">1</span>
</code></pre></div><ul><li>Cantidad de inscripciones segun rut enviados por excel y insertados en una tabla temporal</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> CP<span class="token punctuation">.</span>Rut<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>DigitoVerificador<span class="token punctuation">[</span>DIGITO<span class="token punctuation">]</span>
<span class="token punctuation">,</span>INS<span class="token punctuation">.</span>ExpedienteId<span class="token punctuation">[</span>Expediente ID<span class="token punctuation">]</span>
<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> INS<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">[</span>Q Inscripciones Pregrado<span class="token punctuation">]</span>
<span class="token keyword">from</span> Expediente_Expediente EE
<span class="token keyword">JOIN</span> Expediente_Alumno EA <span class="token keyword">ON</span> EE<span class="token punctuation">.</span>AlumnoId <span class="token operator">=</span> EA<span class="token punctuation">.</span>Id <span class="token operator">AND</span> EA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> Common_Persona CP <span class="token keyword">ON</span> EA<span class="token punctuation">.</span>PersonaId <span class="token operator">=</span> CP<span class="token punctuation">.</span>Id <span class="token operator">AND</span> CP<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> <span class="token comment">#TMP TMP ON TMP.rut = CP.Rut -- join con tabla temporal con ruts</span>
<span class="token keyword">JOIN</span> Expediente_Inscripcion INS <span class="token keyword">ON</span> INS<span class="token punctuation">.</span>ExpedienteId <span class="token operator">=</span> EE<span class="token punctuation">.</span>Id	<span class="token operator">AND</span> INS<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> Planificacion_Seccion SS <span class="token keyword">on</span> SS<span class="token punctuation">.</span>id <span class="token operator">=</span> INS<span class="token punctuation">.</span>SeccionId <span class="token operator">and</span> SS<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> Planificacion_PeriodoAcademico PA <span class="token keyword">on</span> PA<span class="token punctuation">.</span>id <span class="token operator">=</span> SS<span class="token punctuation">.</span>PeriodoAcademicoId <span class="token operator">and</span> PA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">and</span> PA<span class="token punctuation">.</span>AnoPeriodo <span class="token operator">=</span> <span class="token number">2021</span> <span class="token operator">and</span> PA<span class="token punctuation">.</span>UnidadAcademicaId <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> INS<span class="token punctuation">.</span>Estado <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">AND</span> EE<span class="token punctuation">.</span>UnidadAcademicaId <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">AND</span> INS<span class="token punctuation">.</span>IsAnulada <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> CP<span class="token punctuation">.</span>Rut<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>DigitoVerificador<span class="token punctuation">,</span>INS<span class="token punctuation">.</span>ExpedienteId
<span class="token keyword">order</span> <span class="token keyword">by</span> CP<span class="token punctuation">.</span>Rut <span class="token keyword">ASC</span>
</code></pre></div><ul><li>Funcion que transforma hora desde el INT de omega</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code>CAST<span class="token punctuation">(</span><span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span>fnObtiene_HoraHorarioSeccion<span class="token punctuation">(</span>PHC<span class="token punctuation">.</span>HoraInicio<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">varchar</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Inicio<span class="token punctuation">]</span>
</code></pre></div><ul><li>Inscripciones segun su ETAPA ID Y CUALQUEIER PARAMETRO Q SE DESEE SEGUN SUS JOIN</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">top</span> <span class="token number">100</span> <span class="token operator">*</span>  <span class="token keyword">from</span> InscripcionAsignatura_EtapaInscripcionAsignatura IE
<span class="token keyword">JOIN</span> InscripcionAsignatura_ConfiguracionInscripcionAsignatura CONF <span class="token keyword">ON</span> IE<span class="token punctuation">.</span>ConfiguracionInscripcionAsignaturaId <span class="token operator">=</span> CONF<span class="token punctuation">.</span>Id
<span class="token keyword">JOIN</span> Planificacion_PeriodoAcademico PP <span class="token keyword">ON</span> CONF<span class="token punctuation">.</span>PeriodoAcademicoId <span class="token operator">=</span> PP<span class="token punctuation">.</span>Id
<span class="token keyword">JOIN</span> Planificacion_Seccion PS <span class="token keyword">ON</span> PS<span class="token punctuation">.</span>PeriodoAcademicoId <span class="token operator">=</span> PP<span class="token punctuation">.</span>Id
<span class="token keyword">JOIN</span> Planificacion_HorarioSeccion PHC <span class="token keyword">ON</span> PHC<span class="token punctuation">.</span>SeccionId <span class="token operator">=</span> PS<span class="token punctuation">.</span>Id
<span class="token keyword">where</span>  PS<span class="token punctuation">.</span>SeccionCerrada <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">-- AND PHC.SeccionId = 14777</span>
</code></pre></div><ul><li>Trae las ayudantias realizadas por un instructor, y temas de pago por su correo y opcionalmente una sigla de la asignatura</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code>		<span class="token keyword">SELECT</span> LNK<span class="token punctuation">.</span>Id <span class="token punctuation">,</span>ASI<span class="token punctuation">.</span>Sigla<span class="token punctuation">,</span> NA<span class="token punctuation">.</span>Nombre<span class="token punctuation">,</span> SE<span class="token punctuation">.</span>NumeroSeccion<span class="token punctuation">,</span> PA<span class="token punctuation">.</span>Nombre PeriodoAcademico<span class="token punctuation">,</span> PA<span class="token punctuation">.</span>AnoPeriodo Año<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>LNK<span class="token punctuation">.</span>ValorPago<span class="token punctuation">)</span> Monto<span class="token punctuation">,</span> UA<span class="token punctuation">.</span>CentroDeCosto CentroCosto<span class="token punctuation">,</span> LNK<span class="token punctuation">.</span>Cobrado
		<span class="token keyword">FROM</span> Expediente_Alumno A
		<span class="token keyword">JOIN</span> Planificacion_Instructor I <span class="token keyword">ON</span> I<span class="token punctuation">.</span>PersonaId <span class="token operator">=</span> A<span class="token punctuation">.</span>PersonaId <span class="token operator">AND</span> I<span class="token punctuation">.</span>TipoRolId <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">AND</span> I<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
		<span class="token keyword">JOIN</span> Planificacion_LinkSeccionInstructor LSI <span class="token keyword">ON</span> LSI<span class="token punctuation">.</span>InstructorId <span class="token operator">=</span> I<span class="token punctuation">.</span>Id
		<span class="token keyword">JOIN</span> Planificacion_Seccion SE <span class="token keyword">ON</span> SE<span class="token punctuation">.</span>Id <span class="token operator">=</span> LSI<span class="token punctuation">.</span>SeccionId <span class="token operator">AND</span> SE<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
		<span class="token keyword">JOIN</span> Core_NombreAsignatura NA <span class="token keyword">ON</span> NA<span class="token punctuation">.</span>Id <span class="token operator">=</span> SE<span class="token punctuation">.</span>NombreAsignaturaId <span class="token operator">AND</span> NA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
		<span class="token keyword">JOIN</span> Core_Asignatura ASI <span class="token keyword">ON</span> ASI<span class="token punctuation">.</span>Id <span class="token operator">=</span> SE<span class="token punctuation">.</span>AsignaturaId <span class="token operator">AND</span> ASI<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
		<span class="token keyword">JOIN</span> PagoAyudante_LinkSeccionInstructorMes LNK <span class="token keyword">ON</span> LNK<span class="token punctuation">.</span>LinkSeccionInstructorId <span class="token operator">=</span> LSI<span class="token punctuation">.</span>Id <span class="token operator">AND</span> LNK<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment">--AND LNK.NumeroMes &lt;= DATEPART(MONTH,GETDATE())</span>
		<span class="token keyword">JOIN</span> Planificacion_PeriodoAcademico PA <span class="token keyword">ON</span> PA<span class="token punctuation">.</span>Id <span class="token operator">=</span> SE<span class="token punctuation">.</span>PeriodoAcademicoId <span class="token operator">AND</span> PA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span><span class="token comment">-- AND PA.AnoPeriodo = DATEPART(YEAR,GETDATE()) AND PA.NumeroPeriodo &lt;&gt; 1</span>
		<span class="token keyword">JOIN</span> Core_UnidadAcademica UA <span class="token keyword">ON</span> UA<span class="token punctuation">.</span>Id <span class="token operator">=</span> PA<span class="token punctuation">.</span>UnidadAcademicaId <span class="token operator">AND</span> UA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
		<span class="token keyword">WHERE</span> A<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">AND</span> A<span class="token punctuation">.</span>Email <span class="token operator">=</span> <span class="token string">'alecorrea@alumnos.uai.cl'</span> <span class="token operator">AND</span> LNK<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">AND</span> Sigla <span class="token operator">=</span><span class="token string">'MAT105'</span>
		<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> LNK<span class="token punctuation">.</span>Id <span class="token punctuation">,</span>ASI<span class="token punctuation">.</span>Sigla<span class="token punctuation">,</span> NA<span class="token punctuation">.</span>Nombre<span class="token punctuation">,</span> SE<span class="token punctuation">.</span>NumeroSeccion<span class="token punctuation">,</span> PA<span class="token punctuation">.</span>Nombre<span class="token punctuation">,</span> PA<span class="token punctuation">.</span>AnoPeriodo<span class="token punctuation">,</span> UA<span class="token punctuation">.</span>CentroDeCosto<span class="token punctuation">,</span> PA<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> LNK<span class="token punctuation">.</span>Cobrado
		<span class="token keyword">HAVING</span> <span class="token function">SUM</span><span class="token punctuation">(</span>LNK<span class="token punctuation">.</span>ValorPago<span class="token punctuation">)</span> <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token comment">--AND SUM(LNK.ValorPago) &gt; 0</span>
</code></pre></div><ul><li><p>Ver % de avance de ayudantes segun los RUT ENVIADOS
-- tipoRolId de la tabla planificacionInstuctor = (5 = ayudante)
select EE.Id[Expediente ID]
,CP.Nombre + ' '+ CP.ApellidoPaterno [Nombre]
,EA.Email [Correo]
,CP.Rut[RUT]
,CP.DigitoVerificador [DIGITO VERIFICADOR]
,EEX.DESCRIPCIONESTADO[ESTADO]
,ISNULL(ROUND(EE.PorcentajeAvancePlanEstudio,2),0)[% AVANCE]<br>
from Common_Persona CP
JOIN Expediente_Alumno EA ON CP.Id = EA.PersonaId AND EA.IsDeleted = 0
JOIN Expediente_Expediente EE ON EE.AlumnoId = EA.Id AND EE.IsDeleted = 0
join Expediente_EstadoExpediente EEX ON EE.Estado = EEX.IdEstado AND EEX.IdSubEstado = EE.EstadoInactivo
join Planificacion_Instructor PLI ON PLI.PersonaId = CP.Id AND PLI.TipoRolId = 5
where rut IN (19671003,19035029,19488443,19471216,19842262,20847560)
order by cp.Rut desc</p></li> <li><p>Obtiene las inscripciones vigentes de un alumno segun su Expediente ID y su periodoacademico ID</p></li> <li><p>Ademas trae la informacion de la seccion y el instructor</p></li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> EE<span class="token punctuation">.</span>Id<span class="token punctuation">[</span>Expediente ID<span class="token punctuation">]</span>
<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>Nombre <span class="token operator">+</span> <span class="token string">' '</span><span class="token operator">+</span> CP<span class="token punctuation">.</span>ApellidoPaterno <span class="token punctuation">[</span>Nombre<span class="token punctuation">]</span>
<span class="token punctuation">,</span>EA<span class="token punctuation">.</span>Email <span class="token punctuation">[</span>Correo<span class="token punctuation">]</span>
<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>Rut<span class="token punctuation">[</span>RUT<span class="token punctuation">]</span>
<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>DigitoVerificador <span class="token punctuation">[</span>DIGITO VERIFICADOR<span class="token punctuation">]</span>
<span class="token punctuation">,</span>EEX<span class="token punctuation">.</span>DESCRIPCIONESTADO<span class="token punctuation">[</span>ESTADO<span class="token punctuation">]</span>
<span class="token punctuation">,</span>ISNULL<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span>EE<span class="token punctuation">.</span>PorcentajeAvancePlanEstudio<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">%</span> AVANCE<span class="token punctuation">]</span>  
<span class="token keyword">from</span> Common_Persona CP 
<span class="token keyword">JOIN</span> Expediente_Alumno EA <span class="token keyword">ON</span> CP<span class="token punctuation">.</span>Id <span class="token operator">=</span> EA<span class="token punctuation">.</span>PersonaId <span class="token operator">AND</span> EA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> Expediente_Expediente EE <span class="token keyword">ON</span> EE<span class="token punctuation">.</span>AlumnoId <span class="token operator">=</span> EA<span class="token punctuation">.</span>Id <span class="token operator">AND</span> EE<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">join</span> Expediente_EstadoExpediente EEX <span class="token keyword">ON</span> EE<span class="token punctuation">.</span>Estado <span class="token operator">=</span> EEX<span class="token punctuation">.</span>IdEstado <span class="token operator">AND</span> EEX<span class="token punctuation">.</span>IdSubEstado <span class="token operator">=</span> EE<span class="token punctuation">.</span>EstadoInactivo
<span class="token keyword">join</span> Planificacion_Instructor PLI <span class="token keyword">ON</span> PLI<span class="token punctuation">.</span>PersonaId <span class="token operator">=</span> CP<span class="token punctuation">.</span>Id <span class="token operator">AND</span> PLI<span class="token punctuation">.</span>TipoRolId <span class="token operator">=</span> <span class="token number">5</span>
<span class="token keyword">where</span> rut <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">19671003</span><span class="token punctuation">,</span><span class="token number">19035029</span><span class="token punctuation">,</span><span class="token number">19488443</span><span class="token punctuation">,</span><span class="token number">19471216</span><span class="token punctuation">,</span><span class="token number">19842262</span><span class="token punctuation">,</span><span class="token number">20847560</span><span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> cp<span class="token punctuation">.</span>Rut <span class="token keyword">desc</span>
</code></pre></div><ul><li>Reporte asistencia deporte Vina</li> <li>Ejecutar en Base de datos UAIV</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">distinct</span> NM<span class="token punctuation">.</span>Sigla<span class="token punctuation">,</span>EE<span class="token punctuation">.</span>Id<span class="token punctuation">,</span>cp<span class="token punctuation">.</span>Nombre<span class="token punctuation">,</span>cp<span class="token punctuation">.</span>ApellidoPaterno<span class="token punctuation">,</span>cp<span class="token punctuation">.</span>ApellidoMaterno<span class="token punctuation">,</span>cast<span class="token punctuation">(</span>cp<span class="token punctuation">.</span>Rut <span class="token keyword">as</span> <span class="token keyword">varchar</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span>cp<span class="token punctuation">.</span>DigitoVerificador <span class="token punctuation">[</span>Rut Cumpleto<span class="token punctuation">]</span>
		<span class="token punctuation">,</span>T1<span class="token punctuation">.</span><span class="token operator">*</span><span class="token keyword">from</span> <span class="token punctuation">(</span>

					<span class="token keyword">select</span> tbl1<span class="token punctuation">.</span>rut<span class="token punctuation">[</span>rut<span class="token punctuation">]</span><span class="token punctuation">,</span>
					tbl1<span class="token punctuation">.</span>agosto<span class="token punctuation">[</span>Agosto<span class="token punctuation">]</span><span class="token punctuation">,</span>
					isnull<span class="token punctuation">(</span>tb2<span class="token punctuation">.</span>agosto<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span>Castigo Agosto<span class="token punctuation">]</span><span class="token punctuation">,</span>
					tbl1<span class="token punctuation">.</span>septiembre<span class="token punctuation">[</span>Septiembre<span class="token punctuation">]</span><span class="token punctuation">,</span>
					isnull<span class="token punctuation">(</span>tb2<span class="token punctuation">.</span>septiembre<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span>Castigo Septiembre<span class="token punctuation">]</span><span class="token punctuation">,</span>
					tbl1<span class="token punctuation">.</span>octubre<span class="token punctuation">[</span>Octubre<span class="token punctuation">]</span><span class="token punctuation">,</span>
					isnull<span class="token punctuation">(</span>tb2<span class="token punctuation">.</span>octubre<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span>Castigo Octubre<span class="token punctuation">]</span><span class="token punctuation">,</span>
					tbl1<span class="token punctuation">.</span>noviembre<span class="token punctuation">[</span>Noviembre<span class="token punctuation">]</span><span class="token punctuation">,</span>
					isnull<span class="token punctuation">(</span>tb2<span class="token punctuation">.</span>noviembre<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span>Castigo Noviembre<span class="token punctuation">]</span><span class="token punctuation">,</span>
					tbl1<span class="token punctuation">.</span>diciembre<span class="token punctuation">[</span>Diciembre<span class="token punctuation">]</span><span class="token punctuation">,</span>
					isnull<span class="token punctuation">(</span>tb2<span class="token punctuation">.</span>diciembre<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span>Castigo Diciembre<span class="token punctuation">]</span><span class="token punctuation">,</span>
					tbl1<span class="token punctuation">.</span>agosto <span class="token operator">+</span> tbl1<span class="token punctuation">.</span>septiembre <span class="token operator">+</span> tbl1<span class="token punctuation">.</span>octubre <span class="token operator">+</span> tbl1<span class="token punctuation">.</span>noviembre <span class="token operator">+</span> tbl1<span class="token punctuation">.</span>diciembre 
					<span class="token operator">-</span>isnull<span class="token punctuation">(</span>tb2<span class="token punctuation">.</span>agosto<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> isnull<span class="token punctuation">(</span>tb2<span class="token punctuation">.</span>septiembre<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> isnull<span class="token punctuation">(</span>tb2<span class="token punctuation">.</span>octubre<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> isnull<span class="token punctuation">(</span>tb2<span class="token punctuation">.</span>noviembre<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> isnull<span class="token punctuation">(</span>tb2<span class="token punctuation">.</span>diciembre<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span>Total<span class="token punctuation">]</span>
					<span class="token keyword">from</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>tfAsistencia_ObtienePivot<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'2021-08-02'</span><span class="token punctuation">,</span><span class="token string">'2021-12-13'</span><span class="token punctuation">)</span> tbl1
					<span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>tfCastigos_ObtienePivot<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'2021-08-02'</span><span class="token punctuation">,</span><span class="token string">'2021-12-13'</span><span class="token punctuation">)</span> tb2 <span class="token keyword">on</span> tbl1<span class="token punctuation">.</span>rut <span class="token operator">=</span> tb2<span class="token punctuation">.</span>rut<span class="token punctuation">)</span> <span class="token keyword">as</span> T1
<span class="token keyword">JOIN</span> OmegaDB<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>Common_Persona CP <span class="token keyword">on</span> t1<span class="token punctuation">.</span>rut <span class="token operator">=</span> cp<span class="token punctuation">.</span>Rut <span class="token operator">AND</span> CP<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> OmegaDB<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>Expediente_Alumno EA <span class="token keyword">ON</span> CP<span class="token punctuation">.</span>Id <span class="token operator">=</span> EA<span class="token punctuation">.</span>PersonaId <span class="token operator">AND</span> EA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> OmegaDB<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>Expediente_Expediente EE <span class="token keyword">ON</span> EA<span class="token punctuation">.</span>ID <span class="token operator">=</span> EE<span class="token punctuation">.</span>AlumnoId <span class="token operator">AND</span> EE<span class="token punctuation">.</span>Estado <span class="token operator">=</span><span class="token number">1</span> <span class="token operator">AND</span> EE<span class="token punctuation">.</span>EstadoInactivo <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">AND</span> EE<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">AND</span> EE<span class="token punctuation">.</span>UnidadAcademicaId <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">JOIN</span> OmegaDB<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>Expediente_Inscripcion INS <span class="token keyword">ON</span> EE<span class="token punctuation">.</span>Id <span class="token operator">=</span> INS<span class="token punctuation">.</span>ExpedienteId <span class="token operator">AND</span> INS<span class="token punctuation">.</span>IsAnulada <span class="token operator">=</span><span class="token number">0</span> <span class="token operator">AND</span> INS<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">JOIN</span> OmegaDB<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>Planificacion_Seccion PS <span class="token keyword">ON</span> INS<span class="token punctuation">.</span>SeccionId <span class="token operator">=</span> PS<span class="token punctuation">.</span>Id <span class="token operator">AND</span> PS<span class="token punctuation">.</span>SeccionCerrada <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">AND</span> PS<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">AND</span> PS<span class="token punctuation">.</span>PeriodoAcademicoId <span class="token operator">=</span> <span class="token number">3151</span>
<span class="token keyword">JOIN</span> OmegaDB<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>PlanEstudio_NodoMalla NM <span class="token keyword">ON</span> INS<span class="token punctuation">.</span>NodoMallaId <span class="token operator">=</span> NM<span class="token punctuation">.</span>Id <span class="token operator">AND</span> NM<span class="token punctuation">.</span>TipoAsignatura <span class="token operator">=</span> <span class="token number">3</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">[</span>Rut Cumpleto<span class="token punctuation">]</span>
</code></pre></div><ul><li>Reporte de ayudantes con pagos pendientes</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span>  <span class="token keyword">distinct</span> A<span class="token punctuation">.</span>Email<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>Nombre<span class="token punctuation">,</span>cp<span class="token punctuation">.</span>ApellidoPaterno<span class="token punctuation">,</span>cp<span class="token punctuation">.</span>ApellidoMaterno<span class="token punctuation">,</span>CP<span class="token punctuation">.</span>Rut<span class="token punctuation">,</span>cp<span class="token punctuation">.</span>DigitoVerificador<span class="token punctuation">,</span> ASI<span class="token punctuation">.</span>Sigla<span class="token punctuation">,</span> NA<span class="token punctuation">.</span>Nombre<span class="token punctuation">,</span> SE<span class="token punctuation">.</span>NumeroSeccion<span class="token punctuation">,</span> PA<span class="token punctuation">.</span>Nombre PeriodoAcademico<span class="token punctuation">,</span> PA<span class="token punctuation">.</span>AnoPeriodo Año<span class="token punctuation">,</span>UA<span class="token punctuation">.</span>CentroDeCosto CentroCosto<span class="token punctuation">,</span> LNK<span class="token punctuation">.</span>Cobrado<span class="token punctuation">,</span> UnidadAcademicaId<span class="token punctuation">,</span>LNK<span class="token punctuation">.</span>Id
<span class="token keyword">FROM</span> Expediente_Alumno A
	 <span class="token keyword">JOIN</span> Common_Persona CP <span class="token keyword">ON</span> A<span class="token punctuation">.</span>PersonaId <span class="token operator">=</span> CP<span class="token punctuation">.</span>Id <span class="token operator">AND</span> CP<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
     <span class="token keyword">JOIN</span> Planificacion_Instructor I <span class="token keyword">ON</span> I<span class="token punctuation">.</span>PersonaId <span class="token operator">=</span> A<span class="token punctuation">.</span>PersonaId
                                        <span class="token operator">AND</span> I<span class="token punctuation">.</span>TipoRolId <span class="token operator">=</span> <span class="token number">5</span>
                                        <span class="token operator">AND</span> I<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
     <span class="token keyword">JOIN</span> Planificacion_LinkSeccionInstructor LSI <span class="token keyword">ON</span> LSI<span class="token punctuation">.</span>InstructorId <span class="token operator">=</span> I<span class="token punctuation">.</span>Id
     <span class="token keyword">JOIN</span> Planificacion_Seccion SE <span class="token keyword">ON</span> SE<span class="token punctuation">.</span>Id <span class="token operator">=</span> LSI<span class="token punctuation">.</span>SeccionId
                                      <span class="token operator">AND</span> SE<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
     <span class="token keyword">JOIN</span> Core_NombreAsignatura NA <span class="token keyword">ON</span> NA<span class="token punctuation">.</span>Id <span class="token operator">=</span> SE<span class="token punctuation">.</span>NombreAsignaturaId
                                      <span class="token operator">AND</span> NA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
     <span class="token keyword">JOIN</span> Core_Asignatura ASI <span class="token keyword">ON</span> ASI<span class="token punctuation">.</span>Id <span class="token operator">=</span> SE<span class="token punctuation">.</span>AsignaturaId
                                 <span class="token operator">AND</span> ASI<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
     <span class="token keyword">JOIN</span> PagoAyudante_LinkSeccionInstructorMes LNK <span class="token keyword">ON</span> LNK<span class="token punctuation">.</span>LinkSeccionInstructorId <span class="token operator">=</span> LSI<span class="token punctuation">.</span>Id
                                                       <span class="token operator">AND</span> LNK<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
                                                       <span class="token operator">AND</span> LNK<span class="token punctuation">.</span>Cobrado <span class="token operator">=</span> <span class="token number">0</span>
     <span class="token keyword">JOIN</span> Planificacion_PeriodoAcademico PA <span class="token keyword">ON</span> PA<span class="token punctuation">.</span>Id <span class="token operator">=</span> SE<span class="token punctuation">.</span>PeriodoAcademicoId
                                               <span class="token operator">AND</span> PA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
											   <span class="token operator">AND</span> PA<span class="token punctuation">.</span>ID <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">3150</span><span class="token punctuation">,</span><span class="token number">3151</span><span class="token punctuation">)</span>
     <span class="token keyword">JOIN</span> Core_UnidadAcademica UA <span class="token keyword">ON</span> UA<span class="token punctuation">.</span>Id <span class="token operator">=</span> PA<span class="token punctuation">.</span>UnidadAcademicaId
                                     <span class="token operator">AND</span> UA<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">WHERE</span> A<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
      <span class="token operator">AND</span> LNK<span class="token punctuation">.</span>IsDeleted <span class="token operator">=</span> <span class="token number">0</span>
</code></pre></div><ul><li>Insertar tabla ayupre ayudantes periodo de verano</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Planificacion_Ayupre<span class="token punctuation">(</span>PeriodoAcademicoId<span class="token punctuation">,</span> Procesado<span class="token punctuation">,</span> UsuarioIdCreacion<span class="token punctuation">,</span> FechaCreacion<span class="token punctuation">,</span> UsuarioIdModificacion<span class="token punctuation">,</span> FechaModificacion<span class="token punctuation">,</span> IsDeleted<span class="token punctuation">,</span> DiaInicioSubidaBoleta<span class="token punctuation">,</span> DiaTerminoSubidaBoleta<span class="token punctuation">,</span> DiaDeclaracionMontos<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">3314</span> <span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">,</span> GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">,</span> GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <hr> <ul><li><h4 id="insertar-en-tabla-expediente-expediente"><a href="#insertar-en-tabla-expediente-expediente" class="header-anchor">#</a> Insertar en tabla Expediente_Expediente</h4></li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">begin</span> <span class="token keyword">tran</span> x
<span class="token keyword">insert</span> <span class="token keyword">into</span> Expediente_Expediente
<span class="token keyword">select</span> 
	   ea<span class="token punctuation">.</span>Id
      <span class="token punctuation">,</span>tp<span class="token punctuation">.</span>planId <span class="token comment">-- planid</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.InformacionFinancieraId</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.IcaAlumnoId</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.CeremoniaId</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.UniversidadIntercambioId</span>
      <span class="token punctuation">,</span>cast<span class="token punctuation">(</span>tp<span class="token punctuation">.</span>rut <span class="token keyword">as</span> nvarchar<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span>tp<span class="token punctuation">.</span>dv<span class="token operator">+</span><span class="token string">' - ICOM'</span><span class="token comment">--EE.NumeroExpediente</span>
      <span class="token punctuation">,</span><span class="token number">1</span><span class="token comment">--EE.Estado</span>
      <span class="token punctuation">,</span><span class="token number">1</span><span class="token comment">--EE.EstadoInactivo</span>
      <span class="token punctuation">,</span><span class="token string">'01-01-1900'</span><span class="token comment">--EE.FechaEstadoInactivo</span>
      <span class="token punctuation">,</span><span class="token string">''</span><span class="token comment">--EE.DescripcionEstadoInactivo</span>
      <span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">--EE.FechaIngreso</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.Egresado</span>
      <span class="token punctuation">,</span><span class="token string">'01-01-1900'</span><span class="token comment">--EE.FechaEgreso</span>
      <span class="token punctuation">,</span><span class="token string">'01-01-1900'</span><span class="token comment">--EE.FechaGrado</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.Titulado</span>
      <span class="token punctuation">,</span><span class="token string">'01-01-1900'</span><span class="token comment">--EE.FechaTitulacion</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.ProgramaOtorga</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.Ranking</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.RankingEgreso</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.Extranjero</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.Intercambio</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.TipoIntercambio</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.RecibeCorreosMasivos</span>
      <span class="token punctuation">,</span>tp<span class="token punctuation">.</span>versionPlanEstudioId <span class="token comment">--VersionPlanEstudioId</span>
      <span class="token punctuation">,</span><span class="token number">0</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.SituacionAcademicaId</span>
      <span class="token punctuation">,</span><span class="token number">1</span><span class="token comment">--EE.UsuarioIdCreacion</span>
      <span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">--EE.FechaCreacion</span>
      <span class="token punctuation">,</span><span class="token number">1</span><span class="token comment">--EE.UsuarioIdModificacion</span>
      <span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">--EE.FechaModificacion</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.IsDeleted</span>
      <span class="token punctuation">,</span><span class="token string">''</span><span class="token comment">--EE.NumeroCarpeta</span>
      <span class="token punctuation">,</span>tp<span class="token punctuation">.</span>programaId <span class="token comment">--EE.ProgramaId</span>
      <span class="token punctuation">,</span>tp<span class="token punctuation">.</span>unidadAcademica<span class="token comment">--EE.UnidadAcademicaId</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.PeriodoIngreso</span>
      <span class="token punctuation">,</span>tp<span class="token punctuation">.</span>reglamentoId <span class="token comment">--EE.ReglamentoId</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.PeriodoAvance -- ############################# ESTE DATO DEBE IR SI O SI, ES EL PeriodoAcademicoId cuando Inicia #############################</span>
      <span class="token punctuation">,</span><span class="token boolean">null</span><span class="token comment">--EncuestaSatisfaccionIdLst</span>
      <span class="token punctuation">,</span>tp<span class="token punctuation">.</span>unidadAcademica<span class="token comment">--EE.UnidadAcademicaInscripcionAsignaturaId</span>
      <span class="token punctuation">,</span><span class="token boolean">null</span><span class="token comment">--DeporteRebajadoIdLst</span>
      <span class="token punctuation">,</span><span class="token boolean">null</span><span class="token comment">--InglesRebajadoIdLst</span>
      <span class="token punctuation">,</span><span class="token number">0</span> <span class="token comment">--PeriodoInscripcion</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.PorcentajeAvancePlanEstudio</span>
      <span class="token punctuation">,</span>tp<span class="token punctuation">.</span>expedienteCarrera<span class="token comment">--EE.ExpedienteCarreraId</span>
      <span class="token punctuation">,</span><span class="token boolean">null</span><span class="token comment">--InscripcionRequisitoExtraIdLst</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.TienePeriodoRecuperativo</span>
      <span class="token punctuation">,</span><span class="token boolean">null</span><span class="token comment">--SituacionAcademicaHistoricaIdLst</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.PromedioPonderadoAcumulado</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.PromedioGrado</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.PeriodoAvanceTomaRamos</span>
      <span class="token punctuation">,</span><span class="token number">0</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.EstadoCarrera</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.EstadoGrado</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.ExpedientePrevioExigidoId</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.ExigeExpedientePrevioTerminado</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.TrackHonor</span>
      <span class="token punctuation">,</span><span class="token number">0</span><span class="token comment">--EE.TransaccionId</span>
<span class="token keyword">from</span> <span class="token comment">#tmp tp</span>
<span class="token keyword">join</span> Common_Persona cp <span class="token keyword">on</span> cp<span class="token punctuation">.</span>Rut <span class="token operator">=</span> tp<span class="token punctuation">.</span>rut 
<span class="token keyword">join</span> Expediente_Alumno ea <span class="token keyword">on</span> ea<span class="token punctuation">.</span>PersonaId <span class="token operator">=</span> cp<span class="token punctuation">.</span>Id 
<span class="token comment">--rollback</span>
<span class="token comment">--commit;</span>
</code></pre></div><hr></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/documentacion-vue/guide/apuntes/" class="prev router-link-active">
        General
      </a></span> <span class="next"><a href="/documentacion-vue/guide/apuntes/encochinamiento.html">
        Encochinamiento Objects
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/documentacion-vue/assets/js/app.840065b6.js" defer></script><script src="/documentacion-vue/assets/js/2.b8b9754a.js" defer></script><script src="/documentacion-vue/assets/js/41.3b383c52.js" defer></script>
  </body>
</html>
